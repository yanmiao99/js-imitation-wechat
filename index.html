<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <!-- å…¬å…±æ ·å¼ -->
    <style>
        * {
            margin: 0;
            padding: 0;
        }

        .wrapper {
            display: flex;
            justify-content: space-evenly;
            padding-top: 20px;
            box-sizing: border-box;
        }
    </style>
    <!-- å¯¹è¯æ¡†æ ·å¼ -->
    <style>
        .box {
            width: 375px;
            height: 667px;
            background: #F3F3F3;
            position: relative;
            overflow: hidden;
        }

        .box-in {
            height: 611px;
            padding: 10px 10px 10px 10px;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            overflow-y: scroll;
        }

        /* å…¬å…±æ ·å¼ */
        .left-text-input, .right-text-input {
            width: fit-content;
            max-width: 250px;
            padding: 10px;
            box-sizing: border-box;
            border-radius: 4px;
            color: #333;
            background: #fff;
            position: relative;
            outline: none;
        }

        .left-text-input img,
        .right-text-input img {
            width: 20px;
            vertical-align: top;
        }

        .left-text-input {
            margin-right: auto;
            background: #ffffff;
        }

        .right-text-input {
            margin-left: auto;
            background: #A9EA7A;
        }

        .left-text-input::before,
        .right-text-input::before {
            content: '';
            position: absolute;
            top: 10px;
            width: 0;
            height: 0;
            border: 5px solid transparent;
        }

        .left-text-input::before {
            left: -10px;
            border-right-color: #fff;
        }

        .right-text-input::before {
            right: -10px;
            border-left-color: #A9EA7A;
        }


        .dialog-item {
            display: flex;
            margin-bottom: 10px;
        }

        .left-head-img, .right-head-img {
            width: 40px;
            height: 40px;
            border-radius: 4px;
            background-color: red;
            background-repeat: no-repeat;
            background-size: contain;
        }

        .left-head-img {
            margin-right: 10px;
        }

        .right-head-img {
            margin-left: 10px;
        }

        /* å…¬å…±æ ·å¼ */
        .left-custom-emoji,
        .right-custom-emoji {
            max-width: 125px !important;
            max-height: 100px !important;
            margin-top: 10px;
        }

        .left-custom-emoji {
            margin-right: auto;
        }

        .right-custom-emoji {
            margin-left: auto;
        }

        .box-footer {
            width: 375px;
            height: 56px;
            position: absolute;
            bottom: 0;
            left: 0;
            background: url("./images/footer-text-light.png") no-repeat;
            background-size: 375px 56px;
        }

        /* çº¢åŒ… */
        .he-red-pack {
            width: 230px;
            position: relative;
            border-radius: 4px;
            padding: 0 10px 0 10px;
            box-sizing: border-box;
        }

        .he-red-pack::before {
            content: '';
            position: absolute;
            top: 10px;
            width: 0;
            height: 0;
            border: 5px solid transparent;
            left: -10px;
        }

        .red-pack-top {
            display: flex;
            align-items: center;
            padding: 10px 0 10px 0;
        }

        .red-pack-top img {
            width: 40px;
            height: 40px;
            margin-right: 10px;
        }

        .red-pack-top p {
            font-weight: 400;
            color: #fff;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .red-pack-top span {
            color: #fff;
            font-size: 12px;
        }

        .he-red-pack:not(.income) .red-pack-top span {
            display: none;
        }


        .red-pack-bottom {
            border-top: 1px solid rgba(251, 216, 187, 0.1);
            padding: 3px 0 3px 0;
            box-sizing: border-box;
        }

        .red-pack-bottom span {
            font-size: 10px;
            font-weight: 400;
        }

        /* é¢œè‰²é…ç½® */
        /* å‘é€ */
        .he-red-pack.send {
            background: #F8913F;
        }

        .he-red-pack:not(.income)::before {
            border-right-color: #F8913F;
        }

        .he-red-pack.send .red-pack-bottom {
            color: #FBD8BB;
        }

        /* æ”¶å…¥ */
        .he-red-pack.income {
            background: #F6DDBF;
        }

        .he-red-pack:not(.send)::before {
            border-right-color: #F6DDBF;
        }

        .he-red-pack.income .red-pack-bottom {
            color: #fff;
        }

        /* çº¢åŒ… */
        .self-red-pack {
            width: 230px;
            position: relative;
            border-radius: 4px;
            padding: 0 10px 0 10px;
            box-sizing: border-box;
            margin-left: auto;
        }

        .self-red-pack::before {
            content: '';
            position: absolute;
            top: 10px;
            width: 0;
            height: 0;
            border: 5px solid transparent;
            right: -10px;
        }
        /* é¢œè‰²é…ç½® */
        /* å‘é€ */
        .self-red-pack.send {
            background: #F8913F;
        }

        .self-red-pack:not(.income)::before {
            border-left-color: #F8913F;
        }

        .self-red-pack.send .red-pack-bottom {
            color: #FBD8BB;
        }

        /* æ”¶å…¥ */
        .self-red-pack.income {
            background: #F6DDBF;
        }

        .self-red-pack:not(.send)::before {
            border-left-color: #F6DDBF;
        }

        .self-red-pack.income .red-pack-bottom {
            color: #fff;
        }

        .self-red-pack:not(.income) .red-pack-top span {
            display: none;
        }


    </style>
    <!-- æµ‹è¯•é¢æ¿æ ·å¼ -->
    <style>
        .function-box {
            width: 600px;
            height: 667px;
            background: #F3F3F3;
            position: relative;
            padding: 10px;
            box-sizing: border-box;
            overflow-y: auto;
        }

        .function-item {
            margin: 20px 0;
            user-select: none;
        }

        .function-item > label {
            display: block;
            margin: 10px 0;
        }

        .emoji-box {
            user-select: none;
        }

        label {
            user-select: none;
        }

    </style>
</head>
<body>
<div class="wrapper">
    <!-- å¾®ä¿¡ç›’å­ -->
    <div class="box">
        <div class="box-in">
            <div class="dialog-item">
                <div class="left-head-img"></div>
                <div class="he-red-pack send">
                    <div class="red-pack-top">
                        <img src="./images/pocket-light-pending.png" alt="">
                        <div>
                            <p contenteditable="true">æ­å–œå‘è´¢,å¤§å‰å¤§åˆ©</p>
                            <span>å·²é¢†å–</span>
                        </div>
                    </div>
                    <div class="red-pack-bottom">
                        <span>å¾®ä¿¡çº¢åŒ…</span>
                    </div>
                </div>
            </div>

            <div class="dialog-item">
                <div class="left-head-img"></div>
                <div class="he-red-pack income">
                    <div class="red-pack-top">
                        <img src="./images/pocket-light-received.png" alt="">
                        <div>
                            <p contenteditable="true">æ­å–œå‘è´¢,å¤§å‰å¤§åˆ©</p>
                            <span>å·²é¢†å–</span>
                        </div>
                    </div>
                    <div class="red-pack-bottom">
                        <span>å¾®ä¿¡çº¢åŒ…</span>
                    </div>
                </div>
            </div>

            <div class="dialog-item">
                <div class="self-red-pack send">
                    <div class="red-pack-top">
                        <img src="./images/pocket-light-pending.png" alt="">
                        <div>
                            <p contenteditable="true">æ­å–œå‘è´¢,å¤§å‰å¤§åˆ©</p>
                            <span>å·²é¢†å–</span>
                        </div>
                    </div>
                    <div class="red-pack-bottom">
                        <span>å¾®ä¿¡çº¢åŒ…</span>
                    </div>
                </div>
                <div class="right-head-img"></div>
            </div>

            <div class="dialog-item">
                <div class="self-red-pack income">
                    <div class="red-pack-top">
                        <img src="./images/pocket-light-pending.png" alt="">
                        <div>
                            <p contenteditable="true">æ­å–œå‘è´¢,å¤§å‰å¤§åˆ©</p>
                            <span>å·²é¢†å–</span>
                        </div>
                    </div>
                    <div class="red-pack-bottom">
                        <span>å¾®ä¿¡çº¢åŒ…</span>
                    </div>
                </div>
                <div class="right-head-img"></div>
            </div>

        </div>
        <div class="box-footer"></div>
    </div>

    <!-- ä¾§è¾¹ åŠŸèƒ½åŒº -->
    <div class="function-box">

        <!-- å¯¹è¯æ¡† -->
        <div class="function-item">
            <button class="add-he-dialog">æ·»åŠ ä»–äººå¯¹è¯æ¡†</button>
            <button class="add-self-dialog">æ·»åŠ è‡ªå·±å¯¹è¯æ¡†</button>
        </div>

        <hr>

        <!-- çº¢åŒ…å¯¹è¯æ¡† -->
        <div class="function-item">
            <div>
                <button class="add-he-red-pack-dialog-send">æ·»åŠ ä»–äººçº¢åŒ…å¯¹è¯æ¡†(å‘)</button>
                <button class="add-he-red-pack-dialog-income">æ·»åŠ ä»–äººçº¢åŒ…å¯¹è¯æ¡†(æ”¶)</button>
            </div>
            <div style="margin-top: 10px">
                <button class="add-self-red-pack-dialog-send">æ·»åŠ è‡ªå·±çº¢åŒ…å¯¹è¯æ¡†(å‘)</button>
                <button class="add-self-red-pack-dialog-income">æ·»åŠ è‡ªå·±çº¢åŒ…å¯¹è¯æ¡†(æ”¶)</button>
            </div>
        </div>

        <hr>

        <!-- è‡ªå®šä¹‰è¡¨æƒ…å¯¹è¯æ¡† -->
        <div class="function-item">
            <label>
                æ·»åŠ ä»–äººè‡ªå®šä¹‰è¡¨æƒ…å¯¹è¯æ¡†
                <input type="file" class="add-he-expression-dialog" accept="image/*">
            </label>
            <label>
                æ·»åŠ è‡ªå·±è‡ªå®šä¹‰è¡¨æƒ…å¯¹è¯æ¡†
                <input type="file" class="add-self-expression-dialog" accept="image/*">
            </label>
        </div>

        <hr>

        <!-- å¤´åƒçš„æ›´æ¢ -->
        <div class="function-item">
            <label>
                æ·»åŠ æˆ–ä¿®æ”¹ä»–äººçš„å¤´åƒ ( ä¸è¦ä¸Šä¼ é€æ˜èƒŒæ™¯çš„ )
                <input type="file" class="add-he-head-img" accept="image/*">
            </label>
            <label>
                æ·»åŠ æˆ–ä¿®æ”¹è‡ªå·±çš„å¤´åƒ ( ä¸è¦ä¸Šä¼ é€æ˜èƒŒæ™¯çš„ )
                <input type="file" class="add-self-head-img" accept="image/*">
            </label>
        </div>

        <hr>

        <!-- åœ¨å…‰æ ‡å¤„æ’å…¥è¡¨æƒ… -->
        <div class="function-item">
            <p>ç‚¹å‡»è¡¨æƒ…å³å¯åœ¨å…‰æ ‡å¤„æ’å…¥è¡¨æƒ…</p>
            <div class="emoji-box"></div>
        </div>

        <hr>

        <!-- ä¿å­˜å›¾ç‰‡ -->
        <div class="function-item">
            <button class="save-img"> ä¿å­˜å›¾ç‰‡</button>
        </div>

        <hr>

        <!-- æ’å…¥é‡ç‚¹æ–‡å­— -->
        <div class="function-item">
            <label>
                æ–‡å­— :<input type="text" placeholder="æ–‡å­—" class="key-words">
            </label>
            <label>
                é¢œè‰² :<input type="color" class="key-color" value="#5B6B92">
            </label>
            <div>
                <label>
                    å¸¦ä¸‹åˆ’çº¿
                    <input type="radio" name="drone" class="key-checkbox" value="underline">
                </label>
                <label>
                    ä¸å¸¦ä¸‹åˆ’çº¿
                    <input type="radio" name="drone" class="key-checkbox" value="none" checked>
                </label>
            </div>
            <button class="key-button">åœ¨å…‰æ ‡å¤„æ’å…¥æ–‡å­—</button>
        </div>
    </div>

</div>

<!-- å¼•å…¥ emoji -->
<script src="emoji.js"></script>
<!-- å¼•å…¥ html2canvas -->
<script src="html2canvas.js"></script>

<script>
    // å…¨å±€å˜é‡
    // å·¦è¾¹å¤´åƒ
    let leftHead = null
    // å³è¾¹å¤´åƒ
    let rightHead = null

    // -------------  æ·»åŠ å¯¹è¯æ¡†

    // è·å–æ·»åŠ ä»–äººå¯¹è¯æ¡†
    let addHeDialog = document.querySelector('.add-he-dialog')
    // è·å–æ·»åŠ è‡ªå·±å¯¹è¯æ¡†
    let addSelfDialog = document.querySelector('.add-self-dialog')
    // è·å–ç»„ä»¶ç›’å­
    let boxIn = document.querySelector('.box-in')
    // æ·»åŠ ä»–äººå¯¹è¯æ¡†
    addHeDialog.addEventListener('click', () => {
        // 1. åˆ›å»ºä¸€æ¡æ•°æ®
        let itemDiv = document.createElement('div')
        itemDiv.className = 'dialog-item'
        // 2. åˆ›å»ºå¤´åƒ
        let headDiv = document.createElement('div')
        headDiv.className = 'left-head-img'
        // 2.1 åˆ¤æ–­æ˜¯å¦å·²ç»ä¸Šä¼ å¤´åƒ
        if (leftHead !== null) {
            headDiv.style.backgroundImage = `url(${leftHead})`
        }
        // 3. åˆ›å»ºå¯¹è¯æ¡†div
        let dialogDiv = document.createElement('div')
        dialogDiv.className = 'left-text-input'
        dialogDiv.innerText = 'ç‚¹å‡»ç¼–è¾‘'
        dialogDiv.setAttribute('contenteditable', true)
        // 4. æŠŠå¤´åƒå’Œå¯¹è¯æ¡†æ·»åŠ åˆ°å•æ¡æ•°æ®ä¸­
        itemDiv.appendChild(headDiv)
        itemDiv.appendChild(dialogDiv)
        // 5. æŠŠå•æ¡æ•°æ®æ·»åŠ åˆ°ç›’å­ä¸­
        boxIn.appendChild(itemDiv)
    })
    // æ·»åŠ è‡ªå·±å¯¹è¯æ¡†
    addSelfDialog.addEventListener('click', () => {
        // 1. åˆ›å»ºä¸€æ¡æ•°æ®
        let itemDiv = document.createElement('div')
        itemDiv.className = 'dialog-item'
        // 2. åˆ›å»ºå¤´åƒ
        let headDiv = document.createElement('div')
        headDiv.className = 'right-head-img'
        // 2.1 åˆ¤æ–­æ˜¯å¦å·²ç»ä¸Šä¼ å¤´åƒ
        if (rightHead !== null) {
            headDiv.style.backgroundImage = `url(${rightHead})`
        }
        // 3. åˆ›å»ºå¯¹è¯æ¡†div
        let dialogDiv = document.createElement('div')
        dialogDiv.className = 'right-text-input'
        dialogDiv.innerText = 'ç‚¹å‡»ç¼–è¾‘'
        dialogDiv.setAttribute('contenteditable', true)
        // 4. æŠŠå¤´åƒå’Œå¯¹è¯æ¡†æ·»åŠ åˆ°å•æ¡æ•°æ®ä¸­ ( è¿™ä¸ªè¦å’Œä»–äººçš„é¡ºåºç›¸å )
        itemDiv.appendChild(dialogDiv)
        itemDiv.appendChild(headDiv)
        // 5. æŠŠå•æ¡æ•°æ®æ·»åŠ åˆ°ç›’å­ä¸­
        boxIn.appendChild(itemDiv)
    })

    // -------------  æ·»åŠ å¤´åƒ

    // è·å–æ·»åŠ ä»–äººå¤´åƒ
    let addHeHeadImg = document.querySelector('.add-he-head-img')
    // è·å–æ·»åŠ è‡ªå·±å¤´åƒ
    let addSelfHeadImg = document.querySelector('.add-self-head-img')
    // æ·»åŠ ä»–äººå¤´åƒ
    addHeHeadImg.addEventListener('change', function () {
        let blob = this.files[0]
        //åˆ›å»ºæ–‡ä»¶è¯»å–å¯¹è±¡
        let reader = new FileReader();
        reader.readAsDataURL(blob);
        //ç›‘å¬æ–‡ä»¶è¯»å–ç»“æŸåäº‹ä»¶
        reader.onloadend = function (e) {
            let headImg = document.querySelectorAll('.left-head-img')
            headImg.forEach(item => {
                item.style.backgroundImage = `url(${e.target.result})`
            })
            // æš´éœ²å˜é‡ç»™å…¨å±€
            leftHead = e.target.result
        };
    })
    //æ·»åŠ è‡ªå·±å¤´åƒ
    addSelfHeadImg.addEventListener('change', function () {
        let blob = this.files[0]
        //åˆ›å»ºæ–‡ä»¶è¯»å–å¯¹è±¡
        let reader = new FileReader();
        reader.readAsDataURL(blob);
        //ç›‘å¬æ–‡ä»¶è¯»å–ç»“æŸåäº‹ä»¶
        reader.onloadend = function (e) {
            let headImg = document.querySelectorAll('.right-head-img')
            headImg.forEach(item => {
                item.style.backgroundImage = `url(${e.target.result})`
            })
            // æš´éœ²å˜é‡ç»™å…¨å±€
            rightHead = e.target.result
        };
    })


    // -------------  è‡ªå®šä¹‰è¡¨æƒ…å¯¹è¯æ¡†
    // è·å–æ·»åŠ ä»–äººè¡¨æƒ…çš„ä¸Šä¼ æ¡†
    let addHeExpressionDialog = document.querySelector('.add-he-expression-dialog')
    // è·å–æ·»åŠ è‡ªå·±è¡¨æƒ…çš„ä¸Šä¼ æ¡†
    let addSelfExpressionDialog = document.querySelector('.add-self-expression-dialog')
    // æ·»åŠ ä»–äººè¡¨æƒ…
    addHeExpressionDialog.addEventListener('change', function () {
        let blob = this.files[0]
        //åˆ›å»ºæ–‡ä»¶è¯»å–å¯¹è±¡
        let reader = new FileReader();
        reader.readAsDataURL(blob);
        //ç›‘å¬æ–‡ä»¶è¯»å–ç»“æŸåäº‹ä»¶
        reader.onloadend = function (e) {
            // 1. åˆ›å»ºä¸€æ¡æ•°æ®
            let itemDiv = document.createElement('div')
            itemDiv.className = 'dialog-item'
            // 2. åˆ›å»ºå¤´åƒ
            let headDiv = document.createElement('div')
            headDiv.className = 'left-head-img'
            // 2.1 åˆ¤æ–­æ˜¯å¦å·²ç»ä¸Šä¼ å¤´åƒ
            if (leftHead !== null) {
                headDiv.style.backgroundImage = `url(${leftHead})`
            }
            // 3. åˆ›å»ºå­˜æ”¾è‡ªå®šä¹‰è¡¨æƒ…çš„ img
            let dialogImg = document.createElement('img')
            dialogImg.src = e.target.result
            dialogImg.className = 'left-custom-emoji'
            // 5. æŠŠå¤´åƒå’Œå¯¹è¯æ¡†æ·»åŠ åˆ°å•æ¡æ•°æ®ä¸­
            itemDiv.appendChild(headDiv)
            itemDiv.appendChild(dialogImg)
            // 6. æŠŠå•æ¡æ•°æ®æ·»åŠ åˆ°ç›’å­ä¸­
            boxIn.appendChild(itemDiv)
            // 7. æ¸…ç©ºæ·»åŠ è¡¨æƒ…çš„ input æ¡†ä¸­çš„æ–‡ä»¶
            addSelfExpressionDialog.value = ''
        };
    })
    // æ·»åŠ è‡ªå·±è¡¨æƒ…
    addSelfExpressionDialog.addEventListener('change', function () {
        let blob = this.files[0]
        //åˆ›å»ºæ–‡ä»¶è¯»å–å¯¹è±¡
        let reader = new FileReader();
        reader.readAsDataURL(blob);
        //ç›‘å¬æ–‡ä»¶è¯»å–ç»“æŸåäº‹ä»¶
        reader.onloadend = function (e) {
            // 1. åˆ›å»ºä¸€æ¡æ•°æ®
            let itemDiv = document.createElement('div')
            itemDiv.className = 'dialog-item'
            // 2. åˆ›å»ºå¤´åƒ
            let headDiv = document.createElement('div')
            headDiv.className = 'right-head-img'
            // 2.1 åˆ¤æ–­æ˜¯å¦å·²ç»ä¸Šä¼ å¤´åƒ
            if (leftHead !== null) {
                headDiv.style.backgroundImage = `url(${leftHead})`
            }
            // 3. åˆ›å»ºå­˜æ”¾è‡ªå®šä¹‰è¡¨æƒ…çš„ img
            let dialogImg = document.createElement('img')
            dialogImg.src = e.target.result
            dialogImg.className = 'right-custom-emoji'
            // 5. æŠŠå¤´åƒå’Œå¯¹è¯æ¡†æ·»åŠ åˆ°å•æ¡æ•°æ®ä¸­
            itemDiv.appendChild(dialogImg)
            itemDiv.appendChild(headDiv)
            // 6. æŠŠå•æ¡æ•°æ®æ·»åŠ åˆ°ç›’å­ä¸­
            boxIn.appendChild(itemDiv)
            // 7. æ¸…ç©ºæ·»åŠ è¡¨æƒ…çš„ input æ¡†ä¸­çš„æ–‡ä»¶
            addSelfExpressionDialog.value = ''
        };
    })

    // -------------  æ·»åŠ æ–‡å­—è¡¨æƒ…

    // è·å–å­˜æ”¾ emoji çš„å®¹å™¨
    let emojiBox = document.querySelector('.emoji-box')
    // å¾ªç¯è¡¨æƒ…å¹¶ä¸”æ¸²æŸ“åˆ°ç•Œé¢ä¸Š
    emoji.forEach(item => {
        let oImg = document.createElement('img')
        oImg.src = item.src
        oImg.alt = item.alt
        oImg.style.width = "20px"
        oImg.style.height = "20px"
        oImg.style.margin = '5px'
        oImg.style.userSelect = 'none'
        emojiBox.appendChild(oImg)
        // æ·»åŠ æ’å…¥è¡¨æƒ…çš„ç‚¹å‡»äº‹ä»¶
        oImg.addEventListener('click', function () {
            insertImg(item.src)
        })
    })


    /**
     * åœ¨å…‰æ ‡å¤„æ’å…¥å›¾ç‰‡
     * @param src è·¯å¾„
     */
    function insertImg(src) {
        if (window.getSelection) {
            let sel = window.getSelection();
            let range = sel.getRangeAt(0);
            let img = new Image();
            range.deleteContents()
            img.src = src;
            range.insertNode(img);
            range.collapse(false); //å¯¹äºIEæ¥è¯´ï¼Œå‚æ•°ä¸å¯çœç•¥
        }
    }

    // -------------  ä¿å­˜å›¾ç‰‡

    // è·å–ä¿å­˜æŒ‰é’®
    let saveImg = document.querySelector('.save-img')

    // ç‚¹å‡»ä¿å­˜æŒ‰é’®
    saveImg.addEventListener('click', () => {
        saveImgFn('å¾®ä¿¡å›¾ç‰‡')
    })

    // // è‡ªåŠ¨ä¿å­˜å›¾ç‰‡ 10 ç§’ä¸€æ¬¡
    // setInterval(() => {
    //     saveImgFn('è‡ªåŠ¨ä¿å­˜')
    // }, 10000)

    // ä¿å­˜å›¾ç‰‡çš„æ–¹æ³•
    function saveImgFn(name) {
        // è·å–éœ€è¦è½¬æ¢çš„dom
        html2canvas(document.querySelector('.box-in'))
            .then(canvas => {
                let imgUrl = canvas.toDataURL('image/jpg')
                let image = document.createElement('img')
                image.src = imgUrl
                let a = document.createElement('a')
                a.href = imgUrl
                a.download = name // è‡ªå®šä¹‰åç§°
                a.click()
            })
    }

    // -------------  åœ¨æ‰€é€‰ä½ç½®æ’å…¥é‡ç‚¹æ–‡å­—


    // è·å– æŒ‰é’®
    let keyBtn = document.querySelector('.key-button')

    // ç‚¹å‡»æ’å…¥é‡ç‚¹æ–‡å­—
    keyBtn.addEventListener('click', () => {
        // è·å– æ–‡å­—
        let keyWords = document.querySelector('.key-words')
        // è·å– é¢œè‰²
        let keyColor = document.querySelector('.key-color')
        // è·å– ä¸‹åˆ’çº¿
        let keyCheckbox = document.querySelector('.key-checkbox:checked')

        // æ’å…¥æ–‡å­—
        insertSpan({
            text: keyWords.value,
            color: keyColor.value,
            underline: keyCheckbox.value
        })
    })

    /**
     * åœ¨å…‰æ ‡å¤„æ’å…¥å…ƒç´ 
     * @param text æ–‡å­—å†…å®¹
     * @param color æ–‡å­—é¢œè‰²
     * @param underline æ˜¯å¦å¸¦æœ‰ä¸‹åˆ’çº¿
     */
    function insertSpan({text, color, underline}) {
        if (window.getSelection) {
            let sel = window.getSelection();
            let range = sel.getRangeAt(0);
            // åˆ›å»ºå…ƒç´ 
            let oSpan = document.createElement('span')
            range.deleteContents()
            oSpan.innerText = text
            oSpan.style.color = color
            oSpan.style.textDecoration = underline
            // æ•´å—é€‰ä¸­/åˆ é™¤
            oSpan.setAttribute('contenteditable', false)
            range.insertNode(oSpan);
            range.collapse(false); //å¯¹äºIEæ¥è¯´ï¼Œå‚æ•°ä¸å¯çœç•¥
        }
    }

    // -------------  çº¢åŒ…ç›¸å…³åŠŸèƒ½ ğŸ§§

    // è·å–çº¢åŒ…ç›¸å…³æŒ‰é’®
    let addHeRedPackDialogSend = document.querySelector('.add-he-red-pack-dialog-send') // ä»–äºº å‘
    let addHeRedPackDialogIncome = document.querySelector('.add-he-red-pack-dialog-income') // ä»–äºº æ”¶
    let addSelfRedPackDialogSend = document.querySelector('.add-self-red-pack-dialog-send') // è‡ªå·± å‘
    let addSelfRedPackDialogIncome = document.querySelector('.add-self-red-pack-dialog-income') // è‡ªå·± æ”¶


</script>

</body>
</html>
